!function(t){function e(e,n,a){t("html,body").stop().animate({scrollTop:e},n,a)}function n(){var e=v.scrollTop();Math.abs(D-e)<=S||(e>D&&e>F-M?C.addClass("glass-nav-up"):e+F<t(document).height()&&C.removeClass("glass-nav-up"),D=e)}function a(){T.length&&T.each(function(){var e=t(this),n=e.find("img").width();e.width(n)})}function i(){var e=t(".glass-post-content"),n=e.children().last();n.is("p")?n.append(" &#8718;"):e.append('<hr class="endpost">')}function o(){var e=t("#subtitle"),n=t(".glass-headline");e.remove(),n.after(e)}function r(){var t=Math.floor((_-k.outerWidth())/2);k.css({top:Math.floor((M+F-k.outerHeight())/2),left:t})}function s(){t(".glass-header").height(F)}function c(){var e=t('img[src$="#cover"]');if(s(),e.length){var n=e.attr("src");e.parent().remove(),t(".glass-cover-image, .glass-cover-image-back").css("backgroundImage","url("+n+")")}}function l(){window.requestAnimationFrame(l);var e=Math.abs(v.scrollTop()),n=((F-1.5*e)/F).toFixed(2),a=.3;0>n&&(n=0),F>e&&(t(".glass-header-wrapper, .glass-scroll-button").css({transform:"translate3d(0,"+(a*e).toFixed(2)+"px,0)",opacity:n}),t(".glass-cover-image").css("opacity",n))}function u(){x.each(function(){var e=t(this);e.data("aspect_ratio",t(this).attr("height")/t(this).attr("width")).height(e.width()*e.data("aspect_ratio"))}),window.requestAnimationFrame(h)}function h(){window.requestAnimationFrame(h);var e=x.first().width(),n=t(".glass-post-body .glass-wrapper").width();n!==e&&x.each(function(){var e=t(this);e.width(n).height(n*e.data("aspect_ratio"))})}function d(e){var n=e.find(".pagination"),a=t(".older-posts",n),i=t(".newer-posts",n),o=t(".page-number",n).html(),r=a.attr("href"),s=i.attr("href");a.attr("href")?A.removeClass("hidden"):A.addClass("hidden"),i.attr("href")?q.removeClass("hidden"):q.addClass("hidden"),y.html(o),A.attr("href",r),q.attr("href",s)}function m(e){t("title").html(e)}function f(t,e,n){m(t),d(e),b.html(n)}function p(n,a,i){"undefined"==typeof i&&(i=!1),t.get(n,function(o){var r=t(o),s=t("#glass-posts",r).first().html(),c=r.filter("title").text();i?f(c,r,s):(history.pushState({slug:location.pathname.replace("/","")},c,n),b.animate({opacity:0},200,function(){e(a,500,function(){f(c,r,s),b.animate({opacity:1},200)})}))})}function w(){var t=v.width();t!==_&&(_=t,s(),r())}function g(){"undefined"!=typeof history.replaceState&&history.replaceState({slug:location.pathname.replace("/","")},null,null),c(),o(),r(),i(),a(),u(),_>768&&(window.requestAnimationFrame(l),v.scroll(function(){z=!0}),setInterval(function(){z&&(n(),z=!1)},200)),v.resize(function(){w()}),t(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){w()}),t(".glass-scroll-button").click(function(t){t.preventDefault(),e(F,1e3)}),A.add(q).click(function(t){var e=F-M;t.preventDefault(),p(t.target.href,e)}),window.onpopstate=function(){var t=location.href;p(t,null,!0)}}var v=t(window),F=v.height(),b=t("#glass-posts"),y=t(".page-number"),A=t(".older-posts"),q=t(".newer-posts"),C=t(".glass-nav"),k=t(".glass-header-wrapper"),T=t(".caption"),x=t('iframe[src*="//www.youtube.com"], iframe[src*="//player.vimeo.com"]'),M=C.outerHeight(),z=!1,D=0,S=20,_=v.width();!function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),a=Math.max(0,16-(n-t)),i=window.setTimeout(function(){e(n+a)},a);return t=n+a,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),g()}(jQuery);