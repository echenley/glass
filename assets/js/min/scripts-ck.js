!function(t){function e(e,a,n){t("html,body").stop().animate({scrollTop:e},a,n)}function a(){var e=v.scrollTop();Math.abs(S-e)<=_||(e>S&&e>F-D?C.addClass("glass-nav-up"):e+F<t(document).height()&&C.removeClass("glass-nav-up"),S=e)}function n(){k.length&&k.each(function(){var e=t(this),a=e.find("img").width();e.width(a)})}function i(){var e=t(".glass-post-content"),a=e.children().last();a.is("p")?a.append(" &#8718;"):e.append('<hr class="endpost">')}function o(){var e=t("#subtitle"),a=t(".glass-headline");e.remove(),a.after(e)}function r(){T.css({top:(D+F-T.outerHeight())/2,left:(z-T.outerWidth())/2})}function s(){t(".glass-header").height(F)}function c(){var e=t('img[src$="#cover"]');if(s(),e.length){var a=e.attr("src");e.parent().remove(),t(".glass-cover-image, .glass-cover-image-back").css("backgroundImage","url("+a+")")}}function l(){window.requestAnimationFrame(l);var e=Math.abs(v.scrollTop()),a=((F-1.5*e)/F).toFixed(2),n=.3;0>a&&(a=0),F>e&&(t(".glass-header-wrapper, .glass-scroll-button").css({transform:"translate3d(0,"+(n*e).toFixed(2)+"px,0)",opacity:a}),t(".glass-cover-image").css("opacity",a))}function u(){x.each(function(){var e=t(this);e.data("aspect_ratio",t(this).attr("height")/t(this).attr("width")).height(e.width()*e.data("aspect_ratio"))}),window.requestAnimationFrame(d)}function d(){window.requestAnimationFrame(d);var e=x.first().width(),a=t(".glass-post-body .glass-wrapper").width();a!==e&&x.each(function(){var e=t(this);e.width(a).height(a*e.data("aspect_ratio"))})}function h(e){var a=e.find(".pagination"),n=t(".older-posts",a),i=t(".newer-posts",a),o=t(".page-number",a).html(),r=n.attr("href"),s=i.attr("href");n.attr("href")?b.removeClass("hidden"):b.addClass("hidden"),i.attr("href")?q.removeClass("hidden"):q.addClass("hidden"),A.html(o),b.attr("href",r),q.attr("href",s)}function m(e){t("title").html(e)}function f(t,e,a){m(t),h(e),y.html(a)}function p(a,n,i){"undefined"==typeof i&&(i=!1),t.get(a,function(o){var r=t(o),s=t("#glass-posts",r).first().html(),c=r.filter("title").text();i?f(c,r,s):(history.pushState({slug:location.pathname.replace("/","")},c,a),y.animate({opacity:0},200,function(){e(n,500,function(){f(c,r,s),y.animate({opacity:1},200)})}))})}function w(){var t=v.width();t!==z&&(z=t,s(),r())}function g(){"undefined"!=typeof history.replaceState&&history.replaceState({slug:location.pathname.replace("/","")},null,null),c(),o(),r(),i(),n(),u(),z>768&&(1600>z&&window.requestAnimationFrame(l),v.scroll(function(){M=!0}),setInterval(function(){M&&(a(),M=!1)},200)),v.resize(function(){w()}),t(".glass-scroll-button").click(function(t){t.preventDefault(),e(F,1e3)}),b.add(q).click(function(t){var e=F-D;t.preventDefault(),p(t.target.href,e)}),window.onpopstate=function(){var t=location.href;p(t,null,!0)}}var v=t(window),F=v.height(),y=t("#glass-posts"),A=t(".page-number"),b=t(".older-posts"),q=t(".newer-posts"),C=t(".glass-nav"),T=t(".glass-header-wrapper"),k=t(".caption"),x=t('iframe[src*="//www.youtube.com"], iframe[src*="//player.vimeo.com"]'),D=C.outerHeight(),M=!1,S=0,_=20,z=v.width();!function(){for(var t=0,e=["ms","moz","webkit","o"],a=0;a<e.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[e[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[a]+"CancelAnimationFrame"]||window[e[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var a=(new Date).getTime(),n=Math.max(0,16-(a-t)),i=window.setTimeout(function(){e(a+n)},n);return t=a+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),g()}(jQuery);