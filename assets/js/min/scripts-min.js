!function(t){function e(e,a,n){t("html,body").stop().animate({scrollTop:e},a,n)}function a(){var e=F.scrollTop();Math.abs(S-e)<=_||(e>S&&e>b-z?k.addClass("glass-nav-up"):e+b<t(document).height()&&k.removeClass("glass-nav-up"),S=e)}function n(){x.length&&x.each(function(){var e=t(this),a=t(".glass-post-body .glass-wrapper").width();e.width(a)})}function i(){var e=t(".glass-post-content"),a=e.children().last();a.is("p")?a.append(" &#8718;"):e.append('<hr class="endpost">')}function o(){var e=t("#subtitle"),a=t(".glass-headline");e.remove(),a.after(e)}function r(){var t=Math.floor((H-T.outerWidth())/2);T.css({top:Math.floor((z+b-T.outerHeight())/2),left:t})}function s(){t(".glass-header").height(b)}function c(){var e=t('img[src$="#cover"]');if(s(),e.length){var a=e.attr("src");e.parent().remove(),t(".glass-cover-image, .glass-cover-image-back").css("backgroundImage","url("+a+")")}}function l(){window.requestAnimationFrame(l);var e=Math.abs(F.scrollTop()),a=((b-1.5*e)/b).toFixed(2),n=.3;0>a&&(a=0),b>e&&(t(".glass-header-wrapper, .glass-scroll-button").css({transform:"translate3d(0,"+(n*e).toFixed(2)+"px,0)",opacity:a}),t(".glass-cover-image").css("opacity",a))}function h(){M.each(function(){var e=t(this);e.data("aspect_ratio",t(this).attr("height")/t(this).attr("width")).height(e.width()*e.data("aspect_ratio"))}),window.requestAnimationFrame(u)}function u(){window.requestAnimationFrame(u);var e=M.first().width(),a=t(".glass-post-body .glass-wrapper").width();a!==e&&M.each(function(){var e=t(this);e.width(a).height(a*e.data("aspect_ratio"))})}function f(e){var a=e.find(".pagination"),n=t(".older-posts",a),i=t(".newer-posts",a),o=t(".page-number",a).html(),r=n.attr("href"),s=i.attr("href");n.attr("href")?q.removeClass("hidden"):q.addClass("hidden"),i.attr("href")?C.removeClass("hidden"):C.addClass("hidden"),A.html(o),q.attr("href",r),C.attr("href",s)}function m(e){t("title").html(e)}function d(t,e,a){m(t),f(e),y.html(a)}function p(a,n,i){"undefined"==typeof i&&(i=!1),t.get(a,function(o){var r=t(o),s=t("#glass-posts",r).first().html(),c=r.filter("title").text();i?d(c,r,s):(history.pushState({slug:location.pathname.replace("/","")},c,a),y.animate({opacity:0},200,function(){e(n,500,function(){d(c,r,s),y.animate({opacity:1},200)})}))})}function w(){t("a[href*=#]:not([href=#])").click(function(){if(location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname){var a=t(this.hash);if(a=a.length?a:t("[name="+this.hash.slice(1)+"]"),a.length)return e(a.offset().top,1e3),!1}})}function g(){var t=F.width(),e=F.height();(t!==H||e!==b)&&(H=t,b=e,s(),r())}function v(){"undefined"!=typeof history.replaceState&&history.replaceState({slug:location.pathname.replace("/","")},null,null),c(),o(),r(),i(),n(),w(),h(),H>768&&(window.requestAnimationFrame(l),F.scroll(function(){D=!0}),setInterval(function(){D&&(a(),D=!1)},200)),F.resize(function(){g()}),t(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(){g()}),t(".glass-scroll-button").click(function(t){t.preventDefault(),e(b,1e3)}),q.add(C).click(function(t){var e=b-z;t.preventDefault(),p(t.target.href,e)}),window.onpopstate=function(){var t=location.href;p(t,null,!0)}}var F=t(window),b=F.height(),y=t("#glass-posts"),A=t(".page-number"),q=t(".older-posts"),C=t(".newer-posts"),k=t(".glass-nav"),T=t(".glass-header-wrapper"),x=t(".caption"),M=t('iframe[src*="//www.youtube.com"], iframe[src*="//player.vimeo.com"]'),z=k.outerHeight(),D=!1,S=0,_=20,H=F.width();!function(){for(var t=0,e=["ms","moz","webkit","o"],a=0;a<e.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[e[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[a]+"CancelAnimationFrame"]||window[e[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var a=(new Date).getTime(),n=Math.max(0,16-(a-t)),i=window.setTimeout(function(){e(a+n)},n);return t=a+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),v()}(jQuery);